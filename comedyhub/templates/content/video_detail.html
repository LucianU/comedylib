{% extends "base.html" %}

{% block title %}{{ video.title }}{% endblock %}

{% block content %}

<div id="video_detail">
	<div class="video">
		<div class="mediaplayer">
			<div id='mediaplayer'></div>
				<script type="text/javascript">
				  jwplayer('mediaplayer').setup({
					'flashplayer': '{{ STATIC_URL }}mediaplayer/player.swf',
					'id': 'playerID',
					'autostart': 'false',
					'volume': '80',
					'width': '700',
					'height': '400',
					'skin': '{{ STATIC_URL }}mediaplayer/skins/modieus.zip',
					'file': '{{ video.url }}'
				  });
				</script>
		</div>
	</div> <!-- end video-->
    <h4>Related</h4>
	<div class="video-related">
        {% load thumbnail %}
        <ul>
        {% for rel_video in related_videos %}
            <li> <a href="{{ rel_video.get_absolute_url }}"><img src="{% thumbnail rel_video.picture 50x50 crop %}" /></a>
                 <a href="{{ rel_video.get_absolute_url }}">{{ rel_video.title }}</a></li>
        {% empty %}
            <p>No related videos</p>
        {% endfor %}
        </ul>
	</div><!-- end video-related -->
	<div class="affiliate">
		affiliate
	</div><!-- end affiliate -->
	<div class="social">
	
		<div class="rating">
			<div class="like" title="Like">
			{% if request.user.is_authenticated %}
				<a href="/a"></a>
				{% else %}
				<a class="fancybox" href="#loginerror"></a>
				{% endif %}
			</div>
			<div class="rateholder">
				<span class="average">78%</span>
				<span class="nvotes">99999 votes</span>
			</div>	
			<div class="dislike" title="Not like">
				{% if request.user.is_authenticated %}
				<a href="/b"></a>
				{% else %}
				<a class="fancybox" href="#loginerror"></a>
				{% endif %}
			</div>
		</div>
			
		
		<!-- verify auth to enable rating-->
		<ul id="sociallist" >
			{% if request.user.is_authenticated %}
				<li id="addplay-btn" class="playlist leftmargin20">
					<a href="#" title="Add this video to a playlist">Add to Playlist</a>
				</li>
				<li class="bookmark">
					<a href="#" title="Save this video to watch later">Bookmark</a>
				</li>
			{% else %}
				<li class="playlist leftmargin20">
					<a class="fancybox" href="#loginerror" >Add to Playlist</a>
				</li>
				<li class="bookmark">
					<a class="fancybox" href="#loginerror" >Bookmark</a>
				</li>
			{% endif %}
			<li>
				<div class="social-share">
					<p><span>Share</span> this video</p>
					<!-- Facebook button-->
					<a href="#" class="faceb" id="fb_share_btn" title="Share to Facebook"></a>
					<!-- Google button-->
					<a href="https://plus.google.com/share?url={{ request.get_host }}{{ request.path }}" onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" class="google"><img
  src="https://www.gstatic.com/images/icons/gplus-32.png" title="Share on Google+"/>
					</a>
					<!-- Reddit button-->				
					<a href="http://www.reddit.com/submit?url={{ request.get_host }}{{ request.path }}" onclick="javascript:window.open(this.href,
  '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=700,width=550');return false;" class="redd" title="Share to Reddit"></a>
				
						<script type="text/javascript">
							$(document).ready(function(){
							$('#fb_share_btn').click(function(e){
							e.preventDefault();
							FB.ui(
							{
							method: 'feed',
							name: '{{video.collection.name}} - {{ video.title}}',
							link: '{{ request.get_host }}{{ request.path }}',
							picture: '{{ request.get_host }}{{ video.picture.url }}',
							caption: '{{ request.get_host }}{{ request.path }}',
							description: 'Watch more {{video.collection.name}} videos at {{ request.get_host }}, the biggest comedy collection.',
							message: ''
							});
							});
							});
						</script>
				</div>
			</li>
		</ul > 
		<div id="addtoplaycontent" class="addtoplaylist">
		Here Will be the list of playlists where you can add this video. Also, here should be created new playlists
		</div>
		<div id="loginerror" style="width:300px;display: none;">
		<h3>Error</h3>
		
			{% if form.errors %}
			<div class="form-error">Your username and password didn't match. Please try again.</div>
			{% endif %}

			<form method="post" action="{% url accounts_login %}">
			{% csrf_token %}
			{{login_form}}
			<div class="submit">
			<input type="submit" id="submit" value="Login" />
			</div>
			<input type="hidden" name="next" value="{{ request.path }}" />
			</form>
		</div> <!-- end loginerror-->
			
<script type="text/javascript">

(function($) {
    $("#addplay-btn").click(function() {
        if ( $("#addtoplaycontent").is(":hidden") ) {
            $("#addtoplaycontent").slideDown("normal"); 
			 } else {
            $("#addtoplaycontent").slideUp("normal");
        }
    });
})(jQuery);
$(document).ready(function() {
		$(".fancybox").fancybox();
	});
$(document).ready(function() {
	$(".various").fancybox({
		maxWidth	: 400,
		maxHeight	: 400,
		fitToView	: false,
		width		: '70%',
		height		: '70%',
		autoSize	: false,
		closeClick	: false,
		openEffect	: 'none',
		closeEffect	: 'none'
	});
});
</script>
	</div><!-- end social -->
	<div class="comments">
		Comments
        {% load comments %}
        {% get_comment_count for video as comment_count %}
        {% if comment_count %}
            <span>{{ comment_count }} comments</span>
        {% endif %}
        {% render_comment_list for video %}
        {% if request.user.is_authenticated %}
            {% get_comment_form for video as comm_form %}
            <form action="{% comment_form_target %}" method="POST">
                {% csrf_token %}
                {{ comm_form.comment }}
                {{ comm_form.honeypot }}
                {{ comm_form.content_type }}
                {{ comm_form.object_pk }}
                {{ comm_form.timestamp }}
                {{ comm_form.security_hash }}
                <input type="hidden" name="next" value="{{ video.get_absolute_url }}" />
                <input type="submit" value="Add comment" id="id_submit" />
            </form>
        {% else %}
            <p>Please <a href="{% url accounts_login %}?next={{ request.path }}">log in</a> to leave a comment.</p>
        {% endif %}
	</div><!-- end comments -->
</div> <!-- end video detail-->
	
{% endblock %}

